{% extends "base.html" %}

{% block title %}
Connexus-view stream
{% endblock %}

{% block css %}
<link rel="stylesheet" href="/assets/StyleSheets/view_stream.css" />
<link rel="stylesheet" href="/assets/Tools/font-awesome/css/font-awesome.min.css" />
<link rel="stylesheet" href="/assets/Tools/lightGallery/css/lightgallery.min.css" />
{% endblock %}

{% block scripts %}
{% if is_owner %}
<script src="/assets/javascripts/fileUploader/dropzone.js" defer></script>
<script src="/assets/javascripts/fileUploader/Queue.js" defer></script>
<script src="/assets/javascripts/fileUploader/main.js" defer></script>
{% endif %}
<script src="/assets/Tools/lightGallery/js/lightgallery.min.js" defer></script>
<script src="/assets/Tools/lightGallery/js/jquery.mousewheel.min.js" defer></script>
<script src="/assets/Tools/lightGallery/js/lg-thumbnail.min.js" defer></script>
<script src="/assets/Tools/lightGallery/js/lg-fullscreen.js" defer></script>
<script src="/assets/Tools/lightGallery/js/lg-zoom.js" defer></script>
<script src="/assets/javascripts/view_stream.js" defer></script>
{% endblock %}

{% block content %}
<h2 class="title" id="view_stream_title">{{stream.name}}</h2>
<div id="stream_info_container">
	<img id="stream_info_cover" src="{{stream.coverImageUrl}}" />
	<table id="stream_info_table" class="words">
		<tr>
			<td class="c1"><b>Owner:</b></td>
			<td class="c2">{{stream.user}}</td>
		</tr>
		<tr>
			<td class="c1"><b>Number of Pictures:</b></td>
			<td class="c2">{{stream.pic_num}}</td>
		</tr>
		<tr>
			<td class="c1"><b>Number of Subscribers:</b></td>
			<td class="c2">{{stream.subscribers|len}}</td>
		</tr>
		<tr>
			<td class="c1"><b>Views:</b></td>
			<td class="c2">{{stream.viewCount}}</td>
		</tr>
		<tr id="tag_row">
			<td class="c1" valign="top"><b>Tags:</b></td>
			<td class="c2" id="tag_content" valign="top">{{stream.tag if stream.tag and stream.tag|len > 0 else "N/A"}}</td>
		</tr>
	</table>
</div>
<div id="images_div">
	{% if images|len > 0 %}
	<table id="light_gallery">
		<tr>
			{% for i in range(offset, offset+images_per_page if (offset+images_per_page)<=(images|len) else images|len) %}
			<td class="image_container" align="center" valign="middle"><a class="gallery_item" href="{{images[i]}}"><img class="image" src="{{images[i]}}"></a></td>
			{% endfor %}
		</tr>
	</table>
	<div id="button_div">
		{% if offset-images_per_page >= 0 %}
		<a class="button" id="prev_page" href="{{view_stream_addr+'/?'+({'id':id, 'offset':offset-images_per_page}|urlencode)}}">Previous Pictures</a>
		{% endif %}
		{% if offset+images_per_page < (images|len) %}
		<a class="button" id="next_page" href="{{view_stream_addr+'/?'+({'id':id, 'offset':offset+images_per_page}|urlencode)}}">More Pictures</a>
		{% endif %}
	</div>
	{% else %}
	<div class="words" id="view_stream_words">
		{% if is_owner %}
		<p>Oops! This stream does not have any pictures!<br>
			Try to add some pictures to enrich your stream!</p>
		{% else %}
		<p>Oops! This stream does not have any pictures!<br>
			Click <a href="{{trending_streams_addr}}">here</a> to find other trending streams, or click <a href="{{search_stream_addr}}">here</a> to search for other interesting streams!</p>
		{% endif %}
	</div>
	{% endif %}
</div>
<div id="upload_div">
	{% if is_owner %}
	<p class="title" id="upload_words">Add Images</p>
	<button class="button" id="bt_choose_files">Select Images</button>
	<button class="button" id="bt_upload_all">Upload All</button>
	<button class="button" id="bt_cancel_all">Cancel All</button>
	<table id="preview_table"></table>
	{% else %}
	<form method="post">
		<input class="button" type="submit" name="subscribe" value={{"Subscribe" if not subscribed else "Unsubscribe"}} />
		<input type="hidden" name="id" value="{{id}}" />
		<input type="hidden" name="offset" value="{{offset}}" />
	</form>
	{% endif %}
</div>
{% endblock %}