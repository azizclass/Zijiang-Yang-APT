{% extends "base.html" %}

{% block title %}
    Connexus-view stream
{% endblock %}

{% block css %}view_stream.css{% endblock %}

{% block content %}
<h2 class="title" id="view_stream_title">{{stream.name}}</h2>
<div id="stream_info_container">
    <img id="stream_info_cover" src="{{stream.coverImageUrl}}" />
	<table id="stream_info_table" class="words">
	    <tr>
			<td class="c1"><b>Owner:</b></td>
			<td class="c2">{{stream.user}}</td>
		</tr>
		<tr>
			<td class="c1"><b>Number of Pictures:</b></td>
			<td class="c2">{{stream.pic_num}}</td>
		</tr>
		<tr>
			<td class="c1"><b>Number of Subscribers:</b></td>
			<td class="c2">{{stream.subscribers|len}}</td>
		</tr>
		<tr>
			<td class="c1"><b>Views:</b></td>
			<td class="c2">{{stream.viewCount}}</td>
		</tr>
		<tr id="tag_row">
			<td class="c1" valign="top"><b>Tags:</b></td>
			<td class="c2" id="tag_content" valign="top">{{stream.tag if stream.tag and stream.tag|len > 0 else "N/A"}}</td>
		</tr>
	</table>
</div>
<div id="images_div">
  {% if images|len > 0 %} 
  	  <table>
	  	  <tr>
    	  {% for i in range(offset, offset+images_per_page if (offset+images_per_page)<=(images|len) else images|len) %}
    	      <td class="image_container" align="center" valign="middle"><img class="image" src="{{images[i]}}"></td>
		  {% endfor %}
		  </tr>
	  </table>
	  <div id="button_div">
	  	   {% if offset-images_per_page >= 0 %}
	  	   	  <a class="button" id="prev_page" href="{{view_stream_addr+'/?'+({'id':id, 'offset':offset-images_per_page}|urlencode)}}">Previous Pictures</a>
	  	   {% endif %}
		   {% if offset+images_per_page < (images|len) %}
		   	  <a class="button" id="next_page" href="{{view_stream_addr+'/?'+({'id':id, 'offset':offset+images_per_page}|urlencode)}}">More Pictures</a>
  	  	   {% endif %}
	  </div>
  {% else %}
  	 <div class="words" id="view_stream_words">
     {% if upload_url %}
     	  <p>Oops! This stream does not have any pictures!<br>
  	  	   Try to add some pictures to enrich your stream!</p> 
     {% else %}
     	  <p>Oops! This stream does not have any pictures!<br>
  	  	   Click <a href="{{trending_streams_addr}}">here</a> to find other trending streams, or click <a href="{{search_stream_addr}}">here</a> to search for other interesting streams!</p>
     {% endif %}
	 </div>
  {% endif %}
</div>
<div id="upload_div">
   {% if upload_url %}
   <form action="{{upload_url}}" method="post" enctype="multipart/form-data">
   		<fieldset id="upload_fieldset">
       		<input type="file" name="img" accept=".jpg,.png,.gif" required/>	
       		<input type="text" name="name" spellcheck="true" placeholder="Name" maxlength="50" required/>
    		<br><textarea id="comments" name="comments" spellcheck="true" placeholder="Comments" rows="5" cols="60"></textarea>		
    		<br><input class="button" id="upload_but" type="submit" name="upload_file" value="Upload file"/>
			<span class="title" id="upload_words">Add an Image</span>
   		</fieldset>
   </form>
   {% else %}
   <form method="post">
   		 <input class="button" type="submit" name="subscribe" value={{"Subscribe" if not subscribed else "Unsubscribe"}} />
		 <input type="hidden" name="id" value="{{id}}" />
		 <input type="hidden" name="offset" value="{{offset}}" />
   </form>
   {% endif %}
</div>
{% endblock %}